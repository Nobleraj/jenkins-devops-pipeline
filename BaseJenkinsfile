pipeline {
    agent any

    stages {
           stage('Remove existing image') {
            steps {
                script {
                    def existingImage = docker.image('my-app:v1')
                    if (existingImage.exists()) {
                        try {
                            existingImage.remove(force: true)
                            println "Image removed successfully."
                        } catch (Exception e) {
                            println "Failed to remove image: ${e.message}"
                            // Handle error accordingly
                        }
                    } else {
                        println "Image does not exist. Skipping removal."
                    }
                }
            }
        }
        stage('Build base image') {
            steps {
                script {
                    // Build the Docker image
                   docker.build("baseimage-${imageTag}:${imageVersion}", "-f BaseDockerfile .")
                }
            }
        }
    }
    
}
